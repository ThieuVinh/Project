<mat-expansion-panel class="mt-3">
    <mat-expansion-panel-header>
        <mat-panel-title>
            <b>{{formGroup.getRawValue().id ? 'Cập Nhật' : 'Thêm'}} Sách</b>
        </mat-panel-title>
    </mat-expansion-panel-header>
    <div class="row form-group">
        <div class="col-12">
            <form class="row" [formGroup]="formGroup" (ngSubmit)="addSach()">
                <div class="col-6">
                    <mat-form-field class="w-100" appearance="outline">
                        <mat-label>Mã sách</mat-label>
                        <input matInput formControlName="ma" type="text" class="w-100">
                        <mat-error
                            *ngIf="formGroup.get('ma')?.hasError('required') && formGroup.get('ma')?.touched">
                            Vui lòng không bỏ trống mã sách
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="col-6">
                    <mat-form-field class="w-100" appearance="outline">
                        <mat-label>Tên sách</mat-label>
                        <input matInput formControlName="ten" type="text" class="w-100">
                        <mat-error
                            *ngIf="formGroup.get('ten')?.hasError('required') && formGroup.get('ten')?.touched">
                            Vui lòng không bỏ trống tên sách
                        </mat-error>
                        <mat-error
                            *ngIf="formGroup.get('ten')?.hasError('minlength') && formGroup.get('ten')?.touched">
                            Tên sách có độ dài tối thiểu là 6 ký tự
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="col-6">
                    <mat-form-field class="w-100" appearance="outline" formGroupName="nhaXuatBan">
                        <mat-label>Nhà xuất bản</mat-label>
                        <mat-select formControlName="id">
                            <mat-option *ngFor="let nxb of nhaXuatBans" [value]="nxb.id">{{nxb.ten}}</mat-option>
                        </mat-select>
                        <mat-error
                            *ngIf="formGroup.get('nhaXuatBan.id')?.hasError('required') && formGroup.get('nhaXuatBan.id')?.touched">
                            Vui lòng không bỏ trống nhà xuất bản
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="col-6">
                    <mat-form-field class="w-100" appearance="outline" formGroupName="tacGia">
                        <mat-label>Tác giả</mat-label>
                        <mat-select formControlName="id">
                            <mat-option *ngFor="let t of tacGias" [value]="t.id">{{t.ten}}</mat-option>
                        </mat-select>
                        <mat-error
                            *ngIf="formGroup.get('tacGia.id')?.hasError('required') && formGroup.get('tacGia.id')?.touched">
                            Vui lòng không bỏ trống tác giả
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="col-6">
                    <mat-form-field class="w-100" appearance="outline">
                        <mat-label>Chủ đề</mat-label>
                        <input matInput formControlName="chuDe" type="text" class="w-100">
                        <mat-error
                            *ngIf="formGroup.get('chuDe')?.hasError('required') && formGroup.get('chuDe')?.touched">
                            Vui lòng không bỏ trống chủ đề
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="col-6">
                    <mat-form-field class="w-100" appearance="outline">
                        <mat-label>Năm sản xuất</mat-label>
                        <input matInput formControlName="namSanXuat" type="datetime-local" class="w-100">
                        <mat-error
                            *ngIf="formGroup.get('namSanXuat')?.hasError('required') && formGroup.get('namSanXuat')?.touched">
                            Vui lòng không bỏ trống năm sản xuất
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="col-6">
                    <mat-form-field class="w-100" appearance="outline">
                        <mat-label>Mô tả</mat-label>
                        <input matInput formControlName="moTa" type="text" class="w-100">
                    </mat-form-field>
                </div>

                <div class="col-6">
                    <mat-form-field class="w-100" appearance="outline">
                        <mat-label>Số lượng đang mượn</mat-label>
                        <input matInput formControlName="soLuongDangMuon" type="text" class="w-100">
                        <mat-error
                            *ngIf="formGroup.get('soLuongDangMuon')?.hasError('required') && formGroup.get('soLuongDangMuon')?.touched">
                            Vui lòng không bỏ trống số lượng đang mượn
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="col-6">
                    <mat-form-field class="w-100" appearance="outline">
                        <mat-label>Số lượng còn lại</mat-label>
                        <input matInput formControlName="soLuongConLai" type="text" class="w-100">
                        <mat-error
                            *ngIf="formGroup.get('soLuongConLai')?.hasError('required') && formGroup.get('soLuongConLai')?.touched">
                            Vui lòng không bỏ trống số lượng còn lại
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="col-6">
                    <mat-form-field class="w-100" appearance="outline">
                        <mat-label>Tổng số sách</mat-label>
                        <input matInput formControlName="tongSoSach" type="text" class="w-100">
                        <mat-error
                            *ngIf="formGroup.get('tongSoSach')?.hasError('required') && formGroup.get('tongSoSach')?.touched">
                            Vui lòng không bỏ trống tổng số sách
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="text-center">
                    <button class="btn btn-success">Submit</button>
                    <button class="btn btn-light" type="reset">Clear</button>
                </div>
            </form>
        </div>
    </div>
</mat-expansion-panel>
<br>
<mat-expansion-panel [expanded]="true">
    <mat-expansion-panel-header>
        <mat-panel-title>
            <b>Danh Sách</b>
        </mat-panel-title>
    </mat-expansion-panel-header>

    <mat-form-field appearance="standard">
        <mat-label>Tìm kiếm</mat-label>
        <input matInput (keyup)="applyFilter($event)" placeholder="nhập từ khóa......" #input>
    </mat-form-field>

    <table mat-table [dataSource]="dataSource" matSort>
        <!-- Mã sách -->
        <ng-container matColumnDef="ma">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Mã sách</th>
            <td mat-cell *matCellDef="let row"> {{row.ma}} </td>
        </ng-container>

        <!-- Tên sách -->
        <ng-container matColumnDef="ten">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Tên sách</th>
            <td mat-cell *matCellDef="let row"> {{row.ten}}</td>
        </ng-container>

        <!-- Nhà xuất bản -->
        <ng-container matColumnDef="nhaXuatBan">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Nhà xuất bản</th>
            <td mat-cell *matCellDef="let row"> {{row.nhaXuatBan?.ten}} </td>
        </ng-container>

        <!-- Tác giả -->
        <ng-container matColumnDef="tacGia">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Tác giả</th>
            <td mat-cell *matCellDef="let row"> {{row.tacGia?.ten}} </td>
        </ng-container>

        <!-- Chủ đề -->
        <ng-container matColumnDef="chuDe">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Chủ đề</th>
            <td mat-cell *matCellDef="let row"> {{row.chuDe}} </td>
        </ng-container>

        <!-- Năm sản xuất -->
        <ng-container matColumnDef="namSanXuat">
            <th mat-header-cell *matHeaderCellDef> Năm sản xuất</th>
            <td mat-cell *matCellDef="let row"> {{row.namSanXuat | date: 'dd-MM-yyyy'}} </td>
        </ng-container>

        <!-- Mô tả -->
        <ng-container matColumnDef="moTa">
            <th mat-header-cell *matHeaderCellDef> Mô tả</th>
            <td mat-cell *matCellDef="let row"> {{row.moTa}} </td>
        </ng-container>

        <!-- Số lượng đang mượn -->
        <ng-container matColumnDef="soLuongDangMuon">
            <th mat-header-cell *matHeaderCellDef> Số lượng đang mượn</th>
            <td mat-cell *matCellDef="let row"> {{row.soLuongDangMuon}} </td>
        </ng-container>

        <!-- Số lượng còn lại -->
        <ng-container matColumnDef="soLuongConLai">
            <th mat-header-cell *matHeaderCellDef> Số lượng còn lại</th>
            <td mat-cell *matCellDef="let row"> {{row.soLuongConLai}} </td>
        </ng-container>

        <!-- Tổng số sách -->
        <ng-container matColumnDef="tongSoSach">
            <th mat-header-cell *matHeaderCellDef> Tổng số sách</th>
            <td mat-cell *matCellDef="let row"> {{row.tongSoSach}} </td>
        </ng-container>

        <!-- Hành động -->
        <ng-container matColumnDef="hanhDong">
            <th mat-header-cell *matHeaderCellDef>Hành Động</th>
            <td mat-cell *matCellDef="let row">
                <button class="btn btn-outline-success" (click)="edit(row)">
                    <i class="material-icons">edit</i>
                </button>
                <button class="btn btn-outline-danger" (click)="delete(row.id)">
                    <i class="material-icons">delete</i>
                </button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

        <!-- Row shown when there is no matching data. -->
        <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="4">Không tìm thấy từ khóa nào liên quan đến "{{input.value}}"</td>
        </tr>
    </table>
    <mat-paginator [pageSizeOptions]="[5, 10, 25]" aria-label="Select page of sach"></mat-paginator>
</mat-expansion-panel>
